<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Strict//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-strict.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
	<meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
	<title>Follow.js: dependent observable (model.composite)</title>
	<script type="text/javascript" src="common/jquery.min.js"></script>
	<script type="text/javascript" src="../source/external/json2.js"></script>
	<script type="text/javascript" src="../source/follow.ecma.js"></script>
	<script type="text/javascript" src="../source/follow.core.js"></script>
	<script type="text/javascript" src="../source/follow.extend.js"></script>
	<script type="text/javascript" src="../source/follow.mapper.js"></script>
	<script type="text/javascript" src="../source/follow.helper.js"></script>
	<!-- <script type="text/javascript" src="../follow.min.js"></script> -->
	<script type="text/javascript">
		$(function()
		{
			var model = Follow('sample');
			
			model
				.follow('init', function()
				{
					this.ui = {
						greeting: $('#greeting'),
						name: {
							first: $(':input[name="name.first"]'),
							second: $(':input[name="name.second"]')
						}
					};
					
					this.ui.name.first
						.add(this.ui.name.second)
						.change(function(){
							model(this.name, this.value);
						});
				}, 'once')
				.dispatch('init');
			
			model('name', function(){
				return {
					first: this.ui.name.first.val(),
					second: this.ui.name.second.val()
				}
			});
			
			model.follow('name.full', function( value )
			{
				this.ui.greeting
					.toggle( !!value )
					.text('Hello, '+ value);
			});
			
			model.composite('name.full', function()
			{
				var name = this('name');
				if( name.first && name.second ){
					return [name.first, name.second].join(' ');
				}
			}, true);
		});
	</script>
</head>
<body>
		
		<style type="text/css">
			* { font:17px "Times New Roman", Times, serif; }
			h2 { font-weight:bold; }
			input { border:1px solid silver; padding:.1em; }
			input:focus { border-color:black; }
			#sample { width:500px; margin:auto; }
		</style>
		<div id="sample">
			<h2>
				<script type="text/javascript">document.write(document.title)</script>
			</h2>
			<div class="name">
				<p>
					First name: <input type="text" name="name.first" value="John" />
				</p>
				<p>
					Second name: <input type="text" name="name.second" value="Smith" />
				</p>
			</div>
			<div id="greeting" style="display:none"></div>
		</div>

</body>
</html>
